<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.slfinalproject.commurest.recommend.repository.RecommendMapper">


    <resultMap id="recommendMap" type="com.slfinalproject.commurest.recommend.domain.Recommend">
        <result property="recommendNo" column="recommend_no"/>
        <result property="boardNo" column="board_no"/>
        <result property="user_id" column="userId"/>
    </resultMap>

    <!-- 게시글 추천 -->
    <insert id="insertRecommend">
        INSERT INTO recommend (board_no, user_id)
        VALUES (#{boardNo}, #{userId})
    </insert>

    <!-- 게시글 추천취소 -->
    <delete id="deleteRecommend">
        DELETE FROM recommend
        WHERE board_no = #{boardNo} AND user_id = #{userId}
    </delete>

    <!-- 게시글 추천 수 -->
    <update id="updateRecommend">
        UPDATE board SET
        recommend = (SELECT COUNT(*) FROM recommend WHERE board_no = #{boardNo})
        WHERE board_no = #{boardNo}
    </update>

    <!-- 중복방지 0 또는 1이 나오는데 0이면 좋아요 안누름 1이면 좋아요 누름-->
    <select id="getRecommend" resultType="int">
        SELECT COUNT(recommend_no) FROM recommend WHERE board_no = #{boardNo} AND user_id = #{userId}
    </select>


</mapper>